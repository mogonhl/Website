<!DOCTYPE html>
<html>
<head>
    <title>Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100vh;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #002420;
            background-image: url('/assets/back.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            background-attachment: fixed;
            color: white;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('/assets/back.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            opacity: 0.2;
            z-index: -1;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            transition: color 0.2s ease;
            font-size: 13px;
            margin: 0 6px;
        }

        .nav-link:hover {
            color: rgba(72, 255, 225, 0.9);
        }

        .nav-link.active {
            color: rgba(72, 255, 225, 0.9);
        }

        .search-bar {
            padding: 8px 12px;
            width: 300px;
            background-color: rgba(0, 0, 0, 0.2);
            border: 1px solid #1a4f44;
            border-radius: 4px;
            color: #ffffff;
        }

        .section {
            background: #0f1a1f;
            border: 1px solid #0a2622;
            transition: all 0.2s ease;
            border-radius: 8px;
            padding: 20px;
        }

        .section:hover {
            background: rgba(15, 26, 31, 0.9);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 10px 0;
            color: #8b9c99;
            font-weight: normal;
            font-size: 12px;
        }

        td {
            padding: 12px 0;
            font-size: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hash-link {
            color: rgba(72, 255, 225, 0.9);
            text-decoration: none;
            transition: color 0.2s ease;
            font-size: 12px;
        }

        .hash-link:hover {
            color: rgba(72, 255, 225, 1);
        }

        .time {
            color: #8b9c99;
            font-size: 12px;
        }

        .view-all {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;

        }

        .view-all-button {
            color: rgba(72, 255, 225, 0.9);
            text-decoration: none;
            font-size: 12px;
            transition: color 0.2s ease;
        }

        .view-all-button:hover {
            color: rgba(72, 255, 225, 1);
        }

        .pagination {
            color: #8b9c99;
            font-size: 12px;
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 36, 32, 0.5);
            backdrop-filter: blur(4px);
            display: none;
            z-index: 50;
            overflow-y: auto;
            padding: 48px 0;
        }

        .modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #0f1a1f;
            border: 1px solid #0a2622;
            border-radius: 8px;
            padding: 24px;
            width: 1280px;
            max-height: none;
            overflow: visible;
        }

        .modal-content {
            background: transparent;
            border: none;
            padding: 0;
            height: auto;
            max-height: none;
            overflow: visible;
        }

        .modal .table-container {
            overflow: visible;
            margin: 0;
            padding: 0;
        }

        .modal thead {
            position: sticky;
            top: 0;
            background: #0f1a1f;
            z-index: 1;
        }

        .modal tbody {
            display: table;
            width: 100%;
        }

        .modal thead, .modal tbody tr {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        .modal thead {
            width: 100%;
        }

        .modal tr {
            height: 42px;
        }

        .modal th {
            padding: 8px 0;
        }

        .modal td {
            padding: 8px 0;
        }

        .modal .text-xl {
            margin-bottom: 12px;
        }

        .modal .view-all {
            margin-top: 12px;
            padding-top: 12px;
        }

        .modal-close {
            position: absolute;
            top: 24px;
            right: 24px;
            color: #8b9c99;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .modal-close:hover {
            color: rgba(72, 255, 225, 0.9);
        }

        /* Add smooth transition for modal */
        .modal-backdrop.active {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Add styles for Coming Soon button and sorry popup */
        .coming-soon {
            transition: transform 0.2s ease;
            cursor: pointer;
            position: relative;
        }

        .coming-soon:hover {
            transform: scale(1.05);
        }

        .sorry-popup {
            position: absolute;
            pointer-events: none;
            z-index: 60;
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .sorry-popup.active {
            opacity: 1;
        }

        .sorry-popup img {
            width: 40px;
            height: 40px;
            object-fit: contain;
        }

        @keyframes popIn {
            0% { transform: scale(0) rotate(0deg); }
            50% { transform: scale(1.1) rotate(var(--rotation)); }
            100% { transform: scale(1) rotate(var(--rotation)); }
        }

        .coming-soon-text {
            position: absolute;
            background: rgba(15, 26, 31, 0.95);
            color: #fff;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            pointer-events: none;
            animation: popupAnimation 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            white-space: nowrap;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            z-index: 50;
        }

        .coming-soon-link {
            position: relative;
        }

        /* Search box styles */
        .search-input {
            padding: 8px 12px;
            background-color: #0f1a1f;
            border: 1px solid #0a2622;
            border-radius: 4px;
            color: #ffffff;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: rgba(72, 255, 225, 0.9);
        }

        .search-type {
            padding: 8px 12px;
            background-color: #0f1a1f;
            border: 1px solid #0a2622;
            border-radius: 4px;
            color: #ffffff;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .search-type:focus {
            outline: none;
            border-color: rgba(72, 255, 225, 0.9);
        }

        /* Remove the old search container styles */
        @media (min-width: 768px) {
            .search-input {
                width: 400px;
            }
        }

        @media (max-width: 767px) {
            .search-input {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <nav class="bg-[#0f1a1f] border-b border-[#0a2622]">
        <div class="flex justify-between items-center h-16 px-6">
            <div class="flex items-center">
                <a href="/" class="flex items-center justify-center h-16">
                    <img src="/assets/Purrgem.png" alt="Logo" class="h-8 w-17 object-contain">
                </a>
                <div class="flex items-center gap-8 ml-8 mt-0.5">
                    <a href="/airdrops" class="nav-link">Airdrops</a>
                    <span class="text-[13px] text-white/50 mx-[6px]">[Shitcoins]</span>
                    <span class="text-[13px] text-white/50 mx-[6px]">[Layer 1's]</span>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-[13px] text-white/50 mx-[6px] mt-0.5">[Chat]</span>
                <a href="/explorer" class="text-[#0f1a1f] bg-[rgba(72,255,225,0.9)] px-3 py-1 rounded text-[13px] hover:bg-[rgba(140,255,235,0.9)] transition-colors">Explorer</a>
                <a href="https://x.com/purrg_hl" target="_blank" class="flex items-center justify-center">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container mx-auto px-4 py-8">
        <div class="min-h-screen pt-12">
            <div class="max-w-7xl mx-auto px-8 pt-20">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-[rgba(72,255,225,0.9)] text-4xl font-bold">Explorer</h1>
                    <div class="flex items-center gap-4">
                        <div class="relative">
                            <input 
                                type="text" 
                                id="searchInput"
                                placeholder="Search by Block, Hash, or Address..." 
                                class="search-input w-[400px] pr-10"
                            />
                            <button 
                                id="searchButton"
                                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-[rgba(72,255,225,0.9)] transition-colors"
                            >
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="section">
                        <div class="section-content">
                            <div class="text-xl mb-4">Latest Blocks</div>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Block</th>
                                            <th>Time</th>
                                            <th>Transactions</th>
                                            <th>Proposer</th>
                                            <th>Hash</th>
                                        </tr>
                                    </thead>
                                    <tbody id="blocks">
                                        <!-- Blocks will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="view-all mt-4">
                                <a href="#" class="view-all-button">View All Blocks</a>
                                <div class="flex items-center gap-2">
                                    <span class="pagination" id="blocks-pagination">1-15 of 300</span>
                                    <div class="flex gap-1">
                                        <button onclick="changePage('blocks', -1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="blocks-prev">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M15 18l-6-6 6-6"/>
                                            </svg>
                                        </button>
                                        <button onclick="changePage('blocks', 1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="blocks-next">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M9 18l6-6-6-6"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-content">
                            <div class="text-xl mb-4 flex items-center gap-2">
                                Latest Transactions
                            </div>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Hash</th>
                                            <th>Action</th>
                                            <th>Block</th>
                                            <th>Time</th>
                                            <th>User</th>
                                        </tr>
                                    </thead>
                                    <tbody id="transactions">
                                        <tr>
                                            <td colspan="5" class="text-center py-8">
                                                <div class="flex items-center justify-center">
                                                    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[rgba(72,255,225,0.9)]"></div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal-backdrop" id="blocksModal">
            <div class="modal">
                <div class="modal-content">
                    <div class="text-xl mb-4">All Blocks</div>
                    <div class="modal-close" onclick="closeModal()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Transactions</th>
                                    <th>Proposer</th>
                                    <th>Hash</th>
                                </tr>
                            </thead>
                            <tbody id="modalBlocks">
                                <!-- Blocks will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="view-all">
                        <div></div>
                        <div class="flex items-center gap-2">
                            <span class="pagination" id="modal-pagination">1-15 of 300</span>
                            <div class="flex gap-1">
                                <button onclick="changeModalPage(-1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="modal-prev">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M15 18l-6-6 6-6"/>
                                    </svg>
                                </button>
                                <button onclick="changeModalPage(1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="modal-next">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 18l6-6-6-6"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Results Modal -->
        <div class="modal-backdrop" id="searchModal">
            <div class="modal">
                <div class="modal-content">
                    <div class="text-xl mb-4" id="searchTitle">Search Results</div>
                    <div class="modal-close" onclick="closeSearchModal()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </div>
                    <div class="table-container">
                        <table>
                            <tbody id="searchResults">
                                <!-- Search results will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="view-all" id="searchPagination" style="display: none;">
                        <div></div>
                        <div class="flex items-center gap-2">
                            <span class="pagination" id="search-pagination">1-15 of 0</span>
                            <div class="flex gap-1">
                                <button onclick="changeSearchPage(-1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="search-prev">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M15 18l-6-6 6-6"/>
                                    </svg>
                                </button>
                                <button onclick="changeSearchPage(1)" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] px-2 disabled:opacity-50" id="search-next">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 18l6-6-6-6"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Store blocks in memory
        let allBlocks = [];
        let currentPage = 1;
        const blocksPerPage = 15;
        const maxBlocks = 300;
        let isPaused = false;
        let queuedBlocks = [];
        let timeUpdateInterval;
        let modalCurrentPage = 1;

        // Format timestamp to "X sec ago"
        const formatTimeAgo = (timestamp) => {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            return `${seconds} sec ago`;
        }

        // Update all visible timestamps
        const updateTimestamps = () => {
            const timeElements = document.querySelectorAll('#blocks td.time, #transactions td.time, #modalBlocks td.time');
            timeElements.forEach(element => {
                const timestamp = parseInt(element.dataset.timestamp);
                if (timestamp) {
                    element.textContent = formatTimeAgo(timestamp);
                }
            });
        }

        // Truncate hash
        const truncateHash = (hash) => {
            return hash.slice(0, 6) + '...' + hash.slice(-4);
        }

        // Update pagination text and buttons
        const updatePagination = () => {
            const start = (currentPage - 1) * blocksPerPage + 1;
            const end = Math.min(currentPage * blocksPerPage, allBlocks.length);
            
            document.getElementById('blocks-pagination').textContent = `${start}-${end} of 300`;
            document.getElementById('blocks-prev').disabled = currentPage === 1;
            document.getElementById('blocks-next').disabled = end >= allBlocks.length;
        }

        // Change page
        const changePage = (type, direction) => {
            const newPage = currentPage + direction;
            const totalPages = Math.ceil(allBlocks.length / blocksPerPage);
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                displayBlocks();
                updatePagination();
            }
        }

        // Display current page of blocks
        const displayBlocks = () => {
            const tbody = document.getElementById('blocks');
            tbody.innerHTML = '';
            
            const start = (currentPage - 1) * blocksPerPage;
            const end = start + blocksPerPage;
            const pageBlocks = allBlocks.slice(start, end);
            
            pageBlocks.forEach(block => {
                const row = document.createElement('tr');
                row.innerHTML = createBlockRow(block);
                tbody.appendChild(row);
            });
        }

        // Create block row HTML
        const createBlockRow = (block) => `
            <tr>
                <td>
                    <div class="flex items-center gap-1">
                        <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                            <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                            <path d="M4 7V17L12 21V11" />
                            <path d="M20 7V17L12 21" />
                        </svg>
                        <a href="#" onclick="performSearch('${block.height}'); return false;" class="hash-link">${block.height}</a>
                    </div>
                </td>
                <td class="time" data-timestamp="${block.blockTime}">${formatTimeAgo(block.blockTime)}</td>
                <td>${block.numTxs}</td>
                <td>${truncateHash(block.proposer)}</td>
                <td>${truncateHash(block.hash)}</td>
            </tr>
        `;

        // Add new block
        const addBlock = (block) => {
            if (isPaused) {
                queuedBlocks.push(block);
                return;
            }

            // Add to the beginning of the array
            allBlocks.unshift(block);
            
            // Keep only the last 300 blocks
            if (allBlocks.length > maxBlocks) {
                allBlocks = allBlocks.slice(0, maxBlocks);
            }
            
            // If we're on the first page, update the display
            if (currentPage === 1) {
                displayBlocks();
            }
            // Update modal if it's open and on first page
            if (modal.classList.contains('active') && modalCurrentPage === 1) {
                displayModalBlocks();
                updateModalPagination();
            }
            updatePagination();
        }

        // Process queued blocks
        const processQueuedBlocks = () => {
            if (queuedBlocks.length > 0) {
                queuedBlocks.forEach(block => {
                    allBlocks.unshift(block);
                });
                
                // Keep only the last 300 blocks
                if (allBlocks.length > maxBlocks) {
                    allBlocks = allBlocks.slice(0, maxBlocks);
                }
                
                if (currentPage === 1) {
                    displayBlocks();
                }
                updatePagination();
                
                queuedBlocks = [];
            }
        }

        // Initialize WebSocket connection
        const init = async () => {
            // Set up hover pause functionality
            const blocksSection = document.querySelector('.section');
            blocksSection.addEventListener('mouseenter', () => {
                isPaused = true;
            });
            
            blocksSection.addEventListener('mouseleave', () => {
                isPaused = false;
                processQueuedBlocks();
            });

            // Start timestamp update interval
            timeUpdateInterval = setInterval(updateTimestamps, 1000);

            const ws = new WebSocket('wss://api.hyperliquid.xyz/ws');

            // Update the transactions table
            const updateTransactionsTable = (transactions) => {
                const tbody = document.getElementById('transactions');
                tbody.innerHTML = transactions.map(tx => `
                    <tr>
                        <td><a href="#" onclick="performSearch('${tx.hash}'); return false;" class="hash-link">${txShortenHash(tx.hash)}</a></td>
                        <td>${tx.action.type}</td>
                        <td>
                            <div class="flex items-center gap-1">
                                <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                    <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                    <path d="M4 7V17L12 21V11" />
                                    <path d="M20 7V17L12 21" />
                                </svg>
                                <a href="#" onclick="performSearch('${tx.block}'); return false;" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)]">${tx.block}</a>
                            </div>
                        </td>
                        <td class="time" data-timestamp="${tx.time}">${formatTimeAgo(tx.time)}</td>
                        <td class="text-[rgba(72,255,225,0.9)]">${txShortenAddress(tx.user)}</td>
                    </tr>
                `).join('');
            };

            ws.onopen = () => {
                // Subscribe to blocks
                ws.send(JSON.stringify({
                    method: "subscribe",
                    subscription: {
                        type: "explorerBlock"
                    }
                }));

                // Subscribe to transactions
                ws.send(JSON.stringify({
                    method: "subscribe",
                    subscription: {
                        type: "transaction"
                    }
                }));
            };

            // Handle WebSocket messages
            ws.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    if (data.channel === "subscriptionResponse") return;

                    if (data.channel === "transaction") {
                        const tx = data.data;
                        const tbody = document.getElementById('transactions');
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td><a href="#" onclick="performSearch('${tx.hash}'); return false;" class="hash-link">${txShortenHash(tx.hash)}</a></td>
                            <td>${tx.action.type}</td>
                            <td>
                                <div class="flex items-center gap-1">
                                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                        <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                        <path d="M4 7V17L12 21V11" />
                                        <path d="M20 7V17L12 21" />
                                    </svg>
                                    <a href="#" onclick="performSearch('${tx.block}'); return false;" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)]">${tx.block}</a>
                                </div>
                            </td>
                            <td class="time" data-timestamp="${tx.time}">${formatTimeAgo(tx.time)}</td>
                            <td class="text-[rgba(72,255,225,0.9)]">${txShortenAddress(tx.user)}</td>
                        `;
                        tbody.insertBefore(row, tbody.firstChild);
                        if (tbody.children.length > 15) {
                            tbody.lastChild.remove();
                        }
                    } else if (Array.isArray(data)) {
                        data.forEach(block => {
                            addBlock(block);
                        });
                    }
                } catch (error) {
                    // Silent error handling
                }
            };

            ws.onerror = (error) => {
                // Silent error handling
            };

            ws.onclose = () => {
                clearInterval(timeUpdateInterval);
            };
        };

        // Start the application
        init();

        // Modal functionality
        const modal = document.getElementById('blocksModal');
        
        function openModal() {
            modal.classList.add('active');
            modalCurrentPage = 1;
            displayModalBlocks();
            updateModalPagination();
        }
        
        function closeModal() {
            modal.classList.remove('active');
        }

        // Close modal when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Display blocks in modal
        function displayModalBlocks() {
            const tbody = document.getElementById('modalBlocks');
            tbody.innerHTML = '';
            
            const start = (modalCurrentPage - 1) * blocksPerPage;
            const end = start + blocksPerPage;
            const pageBlocks = allBlocks.slice(start, end);
            
            pageBlocks.forEach(block => {
                const row = document.createElement('tr');
                row.innerHTML = createBlockRow(block);
                tbody.appendChild(row);
            });
        }

        // Update the view all blocks link
        document.querySelector('.view-all-button').onclick = (e) => {
            e.preventDefault();
            openModal();
        };

        // Change modal page
        function changeModalPage(direction) {
            const newPage = modalCurrentPage + direction;
            const totalPages = Math.ceil(allBlocks.length / blocksPerPage);
            
            if (newPage >= 1 && newPage <= totalPages) {
                modalCurrentPage = newPage;
                displayModalBlocks();
                updateModalPagination();
            }
        }

        // Update modal pagination
        function updateModalPagination() {
            const start = (modalCurrentPage - 1) * blocksPerPage + 1;
            const end = Math.min(modalCurrentPage * blocksPerPage, allBlocks.length);
            
            document.getElementById('modal-pagination').textContent = `${start}-${end} of 300`;
            document.getElementById('modal-prev').disabled = modalCurrentPage === 1;
            document.getElementById('modal-next').disabled = end >= allBlocks.length;
        }

        let activePopups = [];
        let popupTimeout;

        function showSorry(element) {
            // Create new popup
            const popup = document.createElement('div');
            popup.className = 'sorry-popup';
            
            // Random position around the button
            const rect = element.getBoundingClientRect();
            const radius = 100; // Max distance from button
            const angle = Math.random() * Math.PI * 2;
            const x = Math.cos(angle) * (Math.random() * radius);
            const y = Math.sin(angle) * (Math.random() * radius);
            
            // Random rotation and size
            const rotation = -30 + Math.random() * 60; // -30 to +30 degrees
            const scale = 0.8 + Math.random() * 0.4; // 0.8 to 1.2
            
            popup.style.cssText = `
                left: ${rect.left + rect.width/2 + x}px;
                top: ${rect.top + rect.height/2 + y}px;
                transform: translate(-50%, -50%) scale(${scale}) rotate(${rotation}deg);
                animation: popIn 0.3s ease forwards;
                --rotation: ${rotation}deg;
            `;
            
            const img = document.createElement('img');
            img.src = '/assets/sorry.png';
            img.alt = 'Sorry';
            popup.appendChild(img);
            
            document.body.appendChild(popup);
            requestAnimationFrame(() => popup.classList.add('active'));
            
            // Add to active popups
            activePopups.push(popup);
            
            // Clear existing timeout and set new one
            clearTimeout(popupTimeout);
            popupTimeout = setTimeout(clearPopups, 1000);
        }

        function clearPopups() {
            activePopups.forEach(popup => {
                popup.style.opacity = '0';
                setTimeout(() => popup.remove(), 300);
            });
            activePopups = [];
        }

        function showComingSoon(element, event) {
            event.preventDefault();
            
            // Remove any existing popup
            const existingPopup = document.querySelector('.coming-soon-text');
            if (existingPopup) {
                existingPopup.remove();
            }

            // Create popup
            const popup = document.createElement('div');
            popup.textContent = 'Coming Soon';
            popup.className = 'coming-soon-text';
            
            // Position the popup relative to the link
            popup.style.left = '50%';
            popup.style.transform = 'translateX(-50%)';
            popup.style.top = '100%';
            
            // Add to the link
            element.appendChild(popup);
            
            // Remove after animation
            setTimeout(() => {
                popup.remove();
            }, 800);
        }

        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');

            // Function to handle search
            function handleSearch() {
                const query = searchInput.value.trim();
                if (!query) {
                    closeSearchModal();
                    return;
                }
                performSearch(query);
            }

            // Add event listeners for Enter key and search button
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch();
                }
            });

            searchButton.addEventListener('click', handleSearch);

            // Close modal with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeSearchModal();
                }
            });

            // Close modal when clicking outside
            searchModal.addEventListener('click', (e) => {
                if (e.target === searchModal) {
                    closeSearchModal();
                }
            });
        });

        let searchResults = [];
        let searchPage = 1;
        const searchPerPage = 15;
        const searchModal = document.getElementById('searchModal');

        function closeSearchModal() {
            searchModal.classList.remove('active');
        }

        function changeSearchPage(direction) {
            const newPage = searchPage + direction;
            const totalPages = Math.ceil(searchResults.length / searchPerPage);
            
            if (newPage >= 1 && newPage <= totalPages) {
                searchPage = newPage;
                displaySearchResults();
                updateSearchPagination();
            }
        }

        function updateSearchPagination() {
            const start = (searchPage - 1) * searchPerPage + 1;
            const end = Math.min(searchPage * searchPerPage, searchResults.length);
            
            document.getElementById('search-pagination').textContent = `${start}-${end} of ${searchResults.length}`;
            document.getElementById('search-prev').disabled = searchPage === 1;
            document.getElementById('search-next').disabled = end >= searchResults.length;
        }

        // Format time for search results (minutes or higher)
        function formatSearchTime(timestamp) {
            const now = Date.now();
            const diff = Math.floor((now - timestamp) / 1000);

            if (diff < 3600) {
                return `${Math.max(1, Math.floor(diff / 60))} min ago`;
            }
            if (diff < 86400) {
                return `${Math.floor(diff / 3600)} hr ago`;
            }
            return `${Math.floor(diff / 86400)} days ago`;
        }

        function displaySearchResults() {
            const tbody = document.getElementById('searchResults');
            const start = (searchPage - 1) * searchPerPage;
            const end = start + searchPerPage;
            const pageResults = searchResults.slice(start, end);
            
            tbody.innerHTML = pageResults.map(tx => `
                <tr>
                    <td><a href="#" class="hash-link">${tx.block}</a></td>
                    <td><span class="font-mono text-sm">${txShortenHash(tx.hash)}</span></td>
                    <td>${tx.action.type}</td>
                    <td class="text-gray-400 text-sm">${formatSearchTime(tx.time)}</td>
                    <td><span class="font-mono text-sm">${txShortenAddress(tx.user)}</span></td>
                </tr>
            `).join('');
        }

        async function performSearch(query) {
            try {
                // Reset pagination
                searchPage = 1;
                searchResults = [];
                
                // Show loading state in modal
                const searchResultsEl = document.getElementById('searchResults');
                searchResultsEl.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center py-8">
                            <div class="flex items-center justify-center">
                                <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[rgba(72,255,225,0.9)]"></div>
                            </div>
                        </td>
                    </tr>
                `;
                searchModal.classList.add('active');

                // Detect search type and prepare payload
                let payload;
                if (/^\d+$/.test(query)) {
                    // Block number search
                    payload = {
                        type: "blockDetails",
                        height: parseInt(query)
                    };
                    // Update title with block number
                    document.getElementById('searchTitle').innerHTML = `Block <span class="text-[rgba(72,255,225,0.9)]">#${query}</span>`;
                } else if (query.startsWith('0x')) {
                    if (query.length === 66) {
                        // Hash search (transaction hash)
                        payload = {
                            type: "txDetails",
                            hash: query
                        };
                        document.getElementById('searchTitle').innerHTML = `Hash <span class="text-[rgba(72,255,225,0.9)]">${txShortenHash(query)}</span>`;
                    } else {
                        // User address search
                        payload = {
                            type: "userDetails",
                            user: query
                        };
                        document.getElementById('searchTitle').innerHTML = `User <span class="text-[rgba(72,255,225,0.9)]">${txShortenAddress(query)}</span>`;
                    }
                } else {
                    throw new Error('Invalid search query');
                }

                console.log('Search API Request:', {
                    url: 'https://api-ui.hyperliquid.xyz/explorer',
                    method: 'POST',
                    payload
                });

                // Make API call
                const response = await fetch('https://api-ui.hyperliquid.xyz/explorer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });

                console.log('Search API Response Status:', response.status);

                if (!response.ok) {
                    throw new Error(`Search failed with status ${response.status}`);
                }

                const data = await response.json();
                console.log('Search API Response Data:', data);

                if (payload.type === "blockDetails") {
                    if (!data.blockDetails) {
                        searchResultsEl.innerHTML = `
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-400">
                                    Block not found
                                </td>
                            </tr>
                        `;
                        document.getElementById('searchPagination').style.display = 'none';
                        return;
                    }

                    const block = data.blockDetails;
                    searchResults = block.txs || [];
                    
                    if (searchResults.length === 0) {
                        searchResultsEl.innerHTML = `
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-400">
                                    No transactions in this block
                                </td>
                            </tr>
                        `;
                        document.getElementById('searchPagination').style.display = 'none';
                        return;
                    }

                    // Show pagination if we have results
                    document.getElementById('searchPagination').style.display = 'flex';
                    displaySearchResults();
                    updateSearchPagination();
                } else if (payload.type === "txDetails") {
                    if (!data.tx) {
                        searchResultsEl.innerHTML = `
                            <tr>
                                <td colspan="2" class="text-center py-8 text-gray-400">
                                    Transaction not found
                                </td>
                            </tr>
                        `;
                        document.getElementById('searchPagination').style.display = 'none';
                        return;
                    }

                    // Format date for transaction details
                    const txDate = new Date(data.tx.time);
                    const formattedDate = `${txDate.getDate()}.${txDate.getMonth() + 1}.${txDate.getFullYear()} - ${String(txDate.getHours()).padStart(2, '0')}:${String(txDate.getMinutes()).padStart(2, '0')}:${String(txDate.getSeconds()).padStart(2, '0')}`;

                    // Display transaction details in a two-column layout
                    searchResultsEl.innerHTML = `
                        <tr>
                            <td class="py-4 text-gray-400">Hash</td>
                            <td class="py-4">${data.tx.hash}</td>
                        </tr>
                        <tr>
                            <td class="py-4 text-gray-400">Block</td>
                            <td class="py-4 text-[rgba(72,255,225,0.9)]">
                                <div class="flex items-center gap-1">
                                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                        <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                        <path d="M4 7V17L12 21V11" />
                                        <path d="M20 7V17L12 21" />
                                    </svg>
                                    ${data.tx.block}
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="py-4 text-gray-400">Time</td>
                            <td class="py-4">${formattedDate}</td>
                        </tr>
                        <tr>
                            <td class="py-4 text-gray-400">User</td>
                            <td class="py-4 text-[rgba(72,255,225,0.9)]">${data.tx.user}</td>
                        </tr>
                        <tr>
                            <td class="py-4 text-gray-400">Action</td>
                            <td class="py-4">${data.tx.action.type} order</td>
                        </tr>
                        ${data.tx.action.cancels ? `
                        <tr>
                            <td class="py-4 text-gray-400">Order ID</td>
                            <td class="py-4">${data.tx.action.cancels[0].o}</td>
                        </tr>
                        <tr>
                            <td class="py-4 text-gray-400">Coin</td>
                            <td class="py-4">${data.tx.action.cancels[0].a}</td>
                        </tr>
                        ` : ''}`;
                    document.getElementById('searchPagination').style.display = 'none';
                } else if (payload.type === "userDetails") {
                    // First, fetch account info
                    const infoResponse = await fetch('https://api-ui.hyperliquid.xyz/info', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            type: "clearinghouseState",
                            user: query
                        })
                    });

                    const infoData = await infoResponse.json();
                    
                    if (!data.txs || data.txs.length === 0) {
                        searchResultsEl.innerHTML = `
                            <tr>
                                <td colspan="5" class="text-center py-8 text-gray-400">
                                    No transactions found for this user
                                </td>
                            </tr>
                        `;
                        document.getElementById('searchPagination').style.display = 'none';
                        return;
                    }

                    // Show user details with current prices
                    await displayUserDetails(infoData, query, data.txs);
                    // Ensure pagination is hidden for user details
                    document.getElementById('searchPagination').style.display = 'none';
                }

            } catch (error) {
                console.error('Search error:', error);
                document.getElementById('searchResults').innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center py-8 text-red-500">
                            Search failed. Please try again.
                        </td>
                    </tr>
                `;
                document.getElementById('searchPagination').style.display = 'none';
            }
        }

        // Add loadTransactions function
        function loadTransactions() {
            const searchResultsEl = document.getElementById('searchResults');
            const transactions = JSON.parse(searchResultsEl.dataset.transactions);
            const firstFifteen = transactions.slice(0, 15);
            
            searchResultsEl.innerHTML = `
                <tr>
                    <td colspan="5">
                        <div class="mb-4">
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        <td class="py-2 text-gray-400">Hash</td>
                                        <td class="py-2 text-gray-400">Action</td>
                                        <td class="py-2 text-gray-400">Block</td>
                                        <td class="py-2 text-gray-400">Time</td>
                                        <td class="py-2 text-gray-400">User</td>
                                    </tr>
                                </thead>
                                <tbody id="transactionRows">
                                    ${firstFifteen.map(tx => `
                                        <tr>
                                            <td class="py-4 text-[rgba(72,255,225,0.9)]">${txShortenHash(tx.hash)}</td>
                                            <td class="py-4">${tx.action.type}</td>
                                            <td class="py-4">
                                                <div class="flex items-center gap-1">
                                                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                                        <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                                        <path d="M4 7V17L12 21V11" />
                                                        <path d="M20 7V17L12 21" />
                                                    </svg>
                                                    <span class="text-[rgba(72,255,225,0.9)]">${tx.block}</span>
                                                </div>
                                            </td>
                                            <td class="py-4">${formatSearchTime(tx.time)}</td>
                                            <td class="py-4 text-[rgba(72,255,225,0.9)]">${txShortenAddress(tx.user)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <div class="flex justify-center">
                            <button onclick="loadOverview()" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] transition-colors">
                                Back to Overview
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }

        function changeTransactionPage(direction) {
            const searchResultsEl = document.getElementById('searchResults');
            const transactions = JSON.parse(searchResultsEl.dataset.transactions || '[]');
            const newPage = searchPage + direction;
            const totalPages = Math.ceil(transactions.length / searchPerPage);
            
            if (newPage >= 1 && newPage <= totalPages) {
                searchPage = newPage;
                const start = (searchPage - 1) * searchPerPage;
                const end = start + searchPerPage;
                
                // Update table content
                const tbody = document.getElementById('transactionRows');
                if (tbody) {
                    tbody.innerHTML = transactions.slice(start, end).map(tx => `
                        <tr>
                            <td class="py-4 text-[rgba(72,255,225,0.9)]">${txShortenHash(tx.hash)}</td>
                            <td class="py-4">${tx.action.type}</td>
                            <td class="py-4">
                                <div class="flex items-center gap-1">
                                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                        <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                        <path d="M4 7V17L12 21V11" />
                                        <path d="M20 7V17L12 21" />
                                    </svg>
                                    <span class="text-[rgba(72,255,225,0.9)]">${tx.block}</span>
                                </div>
                            </td>
                            <td class="py-4">${formatSearchTime(tx.time)}</td>
                            <td class="py-4 text-[rgba(72,255,225,0.9)]">${txShortenAddress(tx.user)}</td>
                        </tr>
                    `).join('');

                    // Update pagination text and buttons
                    const paginationText = searchResultsEl.querySelector('.pagination');
                    if (paginationText) {
                        paginationText.textContent = `${start + 1}-${Math.min(end, transactions.length)} of ${transactions.length}`;
                    }
                    
                    const prevButton = searchResultsEl.querySelector('button[onclick="changeTransactionPage(-1)"]');
                    const nextButton = searchResultsEl.querySelector('button[onclick="changeTransactionPage(1)"]');
                    if (prevButton) prevButton.disabled = searchPage === 1;
                    if (nextButton) nextButton.disabled = end >= transactions.length;
                }
            }
        }

        function loadOverview() {
            const searchResultsEl = document.getElementById('searchResults');
            searchResultsEl.innerHTML = searchResultsEl.dataset.overview;
        }

        // Add CoinGecko price fetching function
        async function fetchCoinPrices(coins) {
            try {
                const coinIds = {
                    'BTC': 'bitcoin',
                    'ETH': 'ethereum',
                    'SOL': 'solana',
                    'DOGE': 'dogecoin',
                    'XRP': 'ripple',
                    'BNB': 'binancecoin',
                    'AVAX': 'avalanche-2',
                    'MATIC': 'matic-network',
                    'OP': 'optimism',
                    'ARB': 'arbitrum',
                    'APT': 'aptos',
                    'SUI': 'sui',
                    'SEI': 'sei-network',
                    'INJ': 'injective-protocol',
                    'TIA': 'celestia',
                    'STRK': 'starknet'
                };

                const uniqueCoins = [...new Set(coins)];
                const coinGeckoIds = uniqueCoins.map(coin => coinIds[coin]).filter(id => id);
                
                if (coinGeckoIds.length === 0) return {};

                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${coinGeckoIds.join(',')}&vs_currencies=usd`);
                const data = await response.json();
                
                // Convert back to our ticker format
                const prices = {};
                Object.entries(coinIds).forEach(([ticker, id]) => {
                    if (data[id]) {
                        prices[ticker] = data[id].usd;
                    }
                });
                
                return prices;
            } catch (error) {
                console.error('Error fetching prices:', error);
                return {};
            }
        }

        // Update the user details display to include market prices
        async function displayUserDetails(infoData, query, transactions) {
            const searchResultsEl = document.getElementById('searchResults');
            
            // Get all unique coins from positions
            const coins = infoData.assetPositions.map(p => p.position.coin);
            const prices = await fetchCoinPrices(coins);

            searchResultsEl.innerHTML = `
                <tr>
                    <td colspan="5">
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="bg-[#0f1a1f] p-4 rounded">
                                <div class="text-gray-400 text-sm mb-1">Account Value</div>
                                <div class="text-[rgba(72,255,225,0.9)] text-lg">$${parseFloat(infoData.marginSummary.accountValue).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                            </div>
                            <div class="bg-[#0f1a1f] p-4 rounded">
                                <div class="text-gray-400 text-sm mb-1">Total Position Value</div>
                                <div class="text-[rgba(72,255,225,0.9)] text-lg">$${parseFloat(infoData.marginSummary.totalNtlPos).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                            </div>
                        </div>
                        <div>
                            <div class="text-gray-400 text-sm mb-4">Open Positions</div>
                            <div class="grid grid-cols-1">
                                ${(() => {
                                    const shorts = infoData.assetPositions
                                        .filter(p => parseFloat(p.position.szi) < 0)
                                        .sort((a, b) => Math.abs(parseFloat(b.position.positionValue)) - Math.abs(parseFloat(a.position.positionValue)));
                                    const longs = infoData.assetPositions
                                        .filter(p => parseFloat(p.position.szi) > 0)
                                        .sort((a, b) => parseFloat(b.position.positionValue) - parseFloat(a.position.positionValue));
                                    
                                    const totalPositions = shorts.length + longs.length;
                                    
                                    if (totalPositions > 10) {
                                        // Calculate totals
                                        const totalShortValue = shorts.reduce((sum, pos) => sum + Math.abs(parseFloat(pos.position.positionValue)), 0);
                                        const totalLongValue = longs.reduce((sum, pos) => sum + parseFloat(pos.position.positionValue), 0);
                                        
                                        return `
                                            <div class="bg-[#0f1a1f] rounded overflow-hidden">
                                                ${shorts.length > 0 ? `
                                                    <div class="p-4 border-b border-[#1a4f44]">
                                                        <div class="flex items-center justify-between">
                                                            <div class="text-red-400">Open Shorts (${shorts.map(p => p.position.coin).join(', ')})</div>
                                                            <div class="text-sm">$${totalShortValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                                                        </div>
                                                    </div>
                                                ` : ''}
                                                ${longs.length > 0 ? `
                                                    <div class="p-4">
                                                        <div class="flex items-center justify-between">
                                                            <div class="text-green-400">Open Longs (${longs.map(p => p.position.coin).join(', ')})</div>
                                                            <div class="text-sm">$${totalLongValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                                                        </div>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        `;
                                    } else if (totalPositions > 0) {
                                        return `
                                            <div class="bg-[#0f1a1f] rounded overflow-hidden">
                                                ${[...longs, ...shorts].map((pos, index, array) => `
                                                    <div class="p-4 ${index !== array.length - 1 ? 'border-b border-[#1a4f44]' : ''}">
                                                        <div class="flex items-center justify-between">
                                                            <div>
                                                                <span class="${pos.position.szi > 0 ? 'text-green-400' : 'text-red-400'}">${pos.position.coin}</span>
                                                                <span class="${pos.position.szi > 0 ? 'text-green-400 bg-green-400/10' : 'text-red-400 bg-red-400/10'} text-xs px-2 py-0.5 rounded-full ml-2">${pos.position.leverage?.value || ''}x</span>
                                                            </div>
                                                            <div class="text-sm">
                                                                <span class="${pos.position.szi > 0 ? 'text-green-400' : 'text-red-400'}">${parseFloat(pos.position.szi).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                                                                <span class="mx-2">•</span>
                                                                <span>$${parseFloat(pos.position.positionValue).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                                                                <span class="mx-2">•</span>
                                                                <span class="${parseFloat(pos.position.unrealizedPnl) > 0 ? 'text-green-400' : 'text-red-400'}">$${parseFloat(pos.position.unrealizedPnl).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        `;
                                    } else {
                                        return `
                                            <div class="text-center text-gray-400 py-4">
                                                No open positions
                                            </div>
                                        `;
                                    }
                                })()}
                            </div>
                        </div>
                        <div class="flex justify-center mt-6">
                            <button onclick="loadTransactions()" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)] transition-colors">
                                Load Transactions
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            
            // Store the transactions data for later use
            searchResultsEl.dataset.transactions = JSON.stringify(transactions);
            searchResultsEl.dataset.overview = searchResultsEl.innerHTML;

            // Hide pagination
            document.getElementById('searchPagination').style.display = 'none';
        }

        // Update the transactions table
        const updateTransactionsTable = (transactions) => {
            const tbody = document.getElementById('transactions');
            tbody.innerHTML = transactions.map(tx => `
                <tr>
                    <td><a href="#" onclick="performSearch('${tx.hash}'); return false;" class="hash-link">${txShortenHash(tx.hash)}</a></td>
                    <td>${tx.action.type}</td>
                    <td>
                        <div class="flex items-center gap-1">
                            <svg width="12" height="12" viewBox="0 0 24 24" stroke="rgba(72, 255, 225, 0.9)" fill="none" stroke-width="2">
                                <path d="M4 7L12 3L20 7L12 11L4 7Z" />
                                <path d="M4 7V17L12 21V11" />
                                <path d="M20 7V17L12 21" />
                            </svg>
                            <a href="#" onclick="performSearch('${tx.block}'); return false;" class="text-[rgba(72,255,225,0.9)] hover:text-[rgba(72,255,225,1)]">${tx.block}</a>
                        </div>
                    </td>
                    <td class="time" data-timestamp="${tx.time}">${formatTimeAgo(tx.time)}</td>
                    <td class="text-[rgba(72,255,225,0.9)]">${txShortenAddress(tx.user)}</td>
                </tr>
            `).join('');
        };
    </script>
    <script src="/js/transactions.js"></script>
</body>
</html> 